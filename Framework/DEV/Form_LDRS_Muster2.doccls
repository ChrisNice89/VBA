''---------------------------------------------------------------------------------------------------------------------------------
'' Module      : Form_frmGDetail_Customer
'' Author      : Christian Schröer (Deutsche Bundesbank) / Christoph Nitz(KPMG)
'' Last Change : 16.06.2019
'' Purpose     : Dieses Formular enthält alle Sub-Prozeduren und Funktionen, die im Rahmen der Kunden-Detailansicht benötigt werden
''---------------------------------------------------------------------------------------------------------------------------------
'
'Option Compare Database
'Option Explicit
'
'Private Type FormProperties
'    Form As Form_GDetail_Customer
'    CalledFrom As Form_Overview
'End Type
'
'Private mThisForm As FormProperties
'
'Private WithEvents sqlVwDetailGCC As SqlDataViewer
'
'Private Sub Form_Load()
'    Set mThisForm.Form = Me
'    Set sqlVwDetailGCC = iCAT.CreateSqlViewer(ListViewControl:=Me.lv_DetailGCC)
'End Sub
'
'Private Function Blank() As FormProperties: End Function
'Private Sub Form_Unload(Cancel As Integer)
'    mThisForm = Blank
'    Set sqlVwDetailGCC = Nothing
'End Sub
'
'Public Sub Show(ByVal GCC As String, ByVal Customer As Double, ByVal CalledFrom As Form_Overview)
''Übergabeparameter: GCC: Feld 'KNE (Referenz)' aus Hilfstabelle 'tbl_HT_KNE'
''                   (Anbindung über zugehöriges Feld 'KNE (Anzeige)' aus Hilfstabelle 'tbl_HT_KNE')
''                   ('KNE (Anzeige)' stellt die aktuell in der Form 'Overview' angezeigte Kreditnehmer dar)
''Übergabeparameter: Customer: Feld 'Person Personennummer' aus Abfrage 'qGO_OCustomer'
'
'    Screen.MousePointer = 11
'    With mThisForm.Form
'        .Modal = True
'        .Visible = False
'    End With
'
'    Set mThisForm.CalledFrom = CalledFrom
'
'    DoEvents
'
'    Dim lib As QueryLibraryG
'    Set lib = QueryLibraryG.Create(iCAT.Server)
'
'    Debug.Print GCC
'
'    'Datensammlung für Detailanzeige Kreditnehmer (Teil 1)
'    With lib.Customer_Kreditnehmer1(GCC, Customer).Execute
'        If .HasRows Then
'            Me.lbl_Design_Customer = .Fields("Person Name") & " (" & .Fields("Person Personennummer") & ")"
'            Me.lbl_Data_Personennummer = .Fields("Person Personennummer")
'            Me.lbl_Data_Name = .Fields("Person Name")
'            Me.lbl_Data_KNE = VBA.Left$(GCC, InStr(1, GCC, ".", 1) - 1)
'            Me.lbl_Data_KNEName = .Fields("Name")
'            Me.lbl_Data_Strasse = .Fields("Person Straße")
'            Me.lbl_Data_Ort = .Fields("Person PLZ") & " " & .Fields("Person Ort")
'            Me.lbl_Data_Berater = .Fields("Person Berater")
'            Me.lbl_Data_ZwgStName = .Fields("ZwgStName")
'            Me.lbl_Data_Rechtsform = f_KeyDirectory("RF", .Fields("RF"))
'            Me.lbl_Data_Auspraegung = f_KeyDirectory("Person Rechtsform", .Fields("Person Rechtsform"))
'            Me.lbl_Data_WSZ = f_KeyDirectory("Person Wirtschaftszweigschlüssel", .Fields("Person Wirtschaftszweigschlüssel"))
'            Me.lbl_Data_KundeSeit = .Fields("Person Datum Kunde seit")
'            Me.lbl_Data_Prozess = .Fields("Prozess")
'            Me.lbl_Data_Risikorelevanz = f_KeyDirectory("Risikorelevanz MaRisk", .Fields("Risikorelevanz MaRisk"))
'            Me.lbl_Data_18Status = f_KeyDirectory("§18 KWG Überwachungspflicht", .Fields("§18 KWG Überwachungspflicht"))
'            Me.lbl_Data_18Check = f_KeyDirectory("§18 KWG zum Stichtag erfüllt", .Fields("§18 KWG zum Stichtag erfüllt"))
'            Me.lbl_Data_Ratingverfahren = Nz(.Fields("Ratingverfahren"), "n/a")
'            Me.lbl_Data_VRKlasse = Nz(.Fields("Ratingnote"), "n/a") & " (PD " & .Fields("PD") * 100 & "%)"
'            Me.lbl_Data_VRDatum = Nz(.Fields("Person Datum letzte Änderung VR-Rating"), "n/a")
'            Me.lbl_Data_Ausfall = Nz(f_KeyDirectory("Person VR-Rating", .Fields("Person VR-Rating"), 2), "n/a")
'            Me.lbl_Data_Bonitaet = Nz(.Fields("Bonität"), "n/a")
'            Me.lbl_Data_BoniDatum = Nz(.Fields("Person Datum letztes Rating"), "n/a")
'            Me.lbl_Data_Leistungsstoerung = f_KeyDirectory("Person Leistungsstörung", .Fields("Person Leistungsstörung"))
'            Me.lbl_Data_EWB = Format(.Fields("EWB"), "Currency")
'            Me.lbl_Data_Bestandsaufnahme = Nz(.Fields("lztBADat"), "n/a")
'        End If
'    End With
'
'    'Datensammlung für Detailanzeige Kreditnehmer (Teil 2)
'    With lib.Customer_Kreditnehmer2.Execute
'        If .HasRows Then
'            Me.lbl_Data_T_0 = Nz(.Fields("T-0"), "n/a")
'            Me.lbl_Data_T_1 = Nz(.Fields("T-1"), "n/a")
'            Me.lbl_Data_T_2 = Nz(.Fields("T-2"), "n/a")
'        End If
'    End With
'
'    'Datensammlung für Detailanzeige Kreditnehmer (Teil 3)
'    With lib.Customer_Kreditnehmer3(Customer).Execute
'        If .HasRows Then
'            Me.lbl_Data_RV_T_0 = Format(.Fields("RV_T-0"), "Currency")
'            Me.lbl_Data_RV_T_1 = Format(.Fields("RV_T-1"), "Currency")
'            Me.lbl_Data_RV_T_2 = Format(.Fields("RV_T-2"), "Currency")
'            Me.lbl_Data_IA_T_0 = Format(.Fields("IA_T-0"), "Currency")
'            Me.lbl_Data_IA_T_1 = Format(.Fields("IA_T-1"), "Currency")
'            Me.lbl_Data_IA_T_2 = Format(.Fields("IA_T-2"), "Currency")
'            Me.lbl_Data_OZ_T_0 = Format(.Fields("OZ_T-0"), "Currency")
'            Me.lbl_Data_OZ_T_1 = Format(.Fields("OZ_T-1"), "Currency")
'            Me.lbl_Data_OZ_T_2 = Format(.Fields("OZ_T-2"), "Currency")
'            Me.lbl_Data_SI_T_0 = Format(.Fields("SI_T-0"), "Currency")
'            Me.lbl_Data_SI_T_1 = Format(.Fields("SI_T-1"), "Currency")
'            Me.lbl_Data_SI_T_2 = Format(.Fields("SI_T-2"), "Currency")
'            Me.lbl_Data_BV_T_0 = Format(.Fields("RV_T-0") - .Fields("SI_T-0"), "Currency")
'            Me.lbl_Data_BV_T_1 = Format(.Fields("RV_T-1") - .Fields("SI_T-1"), "Currency")
'            Me.lbl_Data_BV_T_2 = Format(.Fields("RV_T-2") - .Fields("SI_T-2"), "Currency")
'            Me.lbl_Data_BE_T_0 = Format(.Fields("BE_T-0"), "Currency")
'            Me.lbl_Data_BE_T_1 = Format(.Fields("BE_T-1"), "Currency")
'            Me.lbl_Data_BE_T_2 = Format(.Fields("BE_T-2"), "Currency")
'            Me.lbl_Data_BI_T_0 = Format(.Fields("BI_T-0"), "Currency")
'            Me.lbl_Data_BI_T_1 = Format(.Fields("BI_T-1"), "Currency")
'            Me.lbl_Data_BI_T_2 = Format(.Fields("BI_T-2"), "Currency")
'        End If
'    End With
'
'    'Datensammlung für Detailanzeige Kreditnehmer (Teil 4)
'    With lib.Customer_Kreditnehmer4(Customer)
'        Set sqlVwDetailGCC.Transaction = .Transaction
'        Call .Execute
'    End With
'
'    Call lib.Source.Disconnect
'    Screen.MousePointer = 0
'    mThisForm.Form.Visible = True
'
'End Sub
'
'Private Sub sqlVwDetailGCC_AfterUpdate(ByVal Successful As Boolean, ByVal Records As Long, ByVal SqlViewer As SqlDataViewer)
'
'    Select Case Records
'        Case 1
'            Me.lblGCCCount.Caption = "Der ausgewählte Kunde gehört zu einer Einheit."
'        Case Else
'            Me.lblGCCCount.Caption = "Der ausgewälte Kunde gehört zu " & Records & " Einheiten."
'    End Select
'
'End Sub
'
'Private Sub sqlVwDetailGCC_dblClick(ByVal Datarow As IDatarow)
'
'    With mThisForm.CalledFrom
'        If Not .fraLookFor.Value = .fraLookFor.DefaultValue Then
'            Call .SetLookFor: .fraLookFor.Value = .fraLookFor.DefaultValue
'        End If
'
'        .cmbLookFor.SetFocus
'        .cmbLookFor.TEXT = Datarow("Einheit")
'    End With
'
'End Sub